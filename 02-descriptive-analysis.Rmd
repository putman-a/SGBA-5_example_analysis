# Descriptive Analysis {#descriptive-analysis}

```{r setup-02-descriptive, include=FALSE}
# load libraries and simulated data ---------------------------------------

library(tidyverse)
library(ggpubr)
library(extrafont)  # for exporting plots with Times New Roman Font

# set seed for reproducibility
set.seed(42)

# load data set (from RDS if using previous script to simulate the data)
sim_data <- read_csv(file = "sim-data.csv")

# store plot theme preset -------------------------------------------------

# store axis options for gender variable plots
gender_plot_theme <-   
  theme_classic() +
  theme(
#    text = element_text(family = 'serif'),
    legend.position = 'none',
    axis.ticks.x = element_blank(),
    axis.text.x = element_blank()
  )

# default density plots and scale
plot_dens_2D <- function(data, x, y){
  plot <- ggplot(data = data, aes(x = x, y = y)) + 
    geom_density_2d_filled(aes(fill = after_stat(level)),
                           bins = 9, contour_var = 'ndensity') +
    scale_fill_brewer(palette = 16, direction = 1, 
                      labels = c('Low', '', '', '','','','','', 'High')) +
    guides(fill = guide_legend(title = 'Density of Occurences', 
                               direction = 'horizontal', nrow = 1, 
                               label.position = 'bottom'))
  plot
}

```

> *Note: for conciseness, the following examples will only show results for two of the four gendered aspects of health items from the SGBA-5 (gender identity, and gender roles)*


## Visualize Distribution of SGBA-5 Responses

### Biological Sex Item

In plot \@ref(fig:02-univar-sex-plot) we see that there are more participants who report their **biological sex** as assigned as female at birth (n=18) than males (n=12). 

```{r 02-univar-sex-plot, fig.cap="Barplot of Biological Sex Responses", fig.width=3.5, fig.height=3.5, fig.align='center', out.width = '50%', echo=FALSE}

# biological sex bar plot
ggplot(sim_data, aes(x = bio_sex)) +
  geom_bar(aes(fill = bio_sex), show.legend = F) + 
  labs(title = 'Barplot of Simulated Biological Sex') +
  ylab('Count') + xlab('Biological Sex') +
  theme_classic() #+
  #theme(text = element_text(family = 'serif'))
```

### Gendered Aspect of Health Items

Looking at the density plots for **gender identity** and **gender role** (figure \@ref(fig:02-univar-gi-plot)), we see that while both variables are bimodal, the **gender identity** responses is more strongly bimodal with one peak closer to the feminine side of the feminine-masculine continuum and one peak closer to masculine end of that continuum. Further, we can also see that in general, participants reported their **gender identity** and **roles** as being more feminine, again with the **gender identity** responses showing this trend more strongly than the **gender role** responses.  

```{r 02-univar-gi-plot, fig.cap="Density plots of Gender Identity and Roles", fig.width=3.5, fig.height=3.5, fig.align='center', fig.show='hold', out.width = '50%', echo=FALSE}
# gender identity density plot
ggplot(sim_data, aes(x = gen_id)) +
  geom_density(alpha=.5, fill = 'forestgreen', colour = 'black') +
  labs(title = 'Density plot of Simulated\nGender Identity Responses') +
  ylab('Density') + xlab('Feminine - Masculine Continuum') +
  gender_plot_theme
# gender role density plot
ggplot(sim_data, aes(x = gen_role)) +
  geom_density(alpha=.5, fill = 'purple2', colour = 'black') +
  labs(title = 'Densityplot of Simulated\nGender Role Responses') +
  ylab('Density') + xlab('Feminine - Masculine Continuum') +
  gender_plot_theme  
```

Presently, there is _<span style="color:red">no clear consensus on how to present descriptive statistics of bimodal variables in health research.</span>_ Reporting the mean(sd) or median(IQR) of a variable does not clearly communicate that there is more than one peak in a bimodal variable’s distribution. 

When taken alongside the SGBA-5’s assumption that the feminine-masculine continuum doesn’t have a true 0 value, it is our suggestion that:

> _If researchers decide to report a descriptive statistic for a bimodally distributed variable, they should report a nominal description of the variable's distriubtion **skew**._ 

For example, if a gendered aspect of health item from the SGBA-5 demonstrates a bimodal distribution, the variable's **skew** can be described along the feminine-masculine continuum instead of reporting the numerical average alone. 

To be able to describe the **skew** of one of the gender variables, the authors suggest calculating the variable’s mean score along the feminine-masculine continuum and then reporting the skew using the suggested nominal classification guide seen in Table \@ref(tab:02-tab). 

_Please note that these suggested classification guidelines are arbitrary and may not be appropriate in all circumstances._ 

``` {r 02-tab, echo=FALSE}
# example of collected data
skew_int <- tibble(
  Mean = c(">70", "55 to 70", "45 to 55", "30 to 45", "<30"),
  Interpretation = c("\"Skews masculine\"", "\"More masculine than feminine\"", "\"Not strongly skewed\"", "\"More feminine than masculine\"", "\"Skews feminine\"")
)

knitr::kable(skew_int, booktabs = TRUE, caption = "Potential Interpretation of Sample Means for Gendered Aspect of Health Items.") %>%
  kableExtra::add_footnote("This table assumes you have recorded the gendered aspects of health items as 0 being the most feminine score and 100 being the most masculine score.", notation = "none")
```

For the simulated dataset represented in the density plots above, the mean score for the **gender identity** item was 50.2 and 46.8 for the **gender role** item. This means that when reporting descriptive statistics on the simulated sample we could report that: <span style="color:purple">“*The simulated sample was not strongly skewed on a feminine to masculine continuum for either the gender identity or gender role measures from the SGBA-5*”</span>. 

## Descriptive Table of SGBA-5 Responses

Taking all these together, an example of a sample characteristics table of the SGBA-5 items in the simulated dataset could be presented as has been displayed in Table \@ref(tab:02-tab02)

``` {r 02-tab02, echo=FALSE}
# example of collected data
sum_tab <- tibble(
  "SGBA Item" = c("Biological Sex (n(%))", "<i>Female</i>", "<i>Intersex</i>", "<i>Male</i>", "Gendered Aspect of Health (skew)", "<i>Gender Identity</i>", "<i>Gendered Roles</i>"),
  "Sample (n = 30)" = c(" ", "14(47%)", NA, "16(53%)", " ", "  Not strongly skewed", "  Not strongly skewed")
)

knitr::kable(sum_tab, booktabs = TRUE, caption = "Simulated sample characteristics.") 
```
